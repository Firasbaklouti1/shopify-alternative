### ==================================================
### CUSTOMER MODULE TEST SCENARIOS
### ==================================================
@host = http://localhost:8080

### SETUP: Register & Login (Required if running standalone)
# @name setup_register
POST {{host}}/api/v1/auth/register
Content-Type: application/json

{
  "storeName": "CustomerStore-{{$random.uuid}}",
  "storeSlug": "c-store-{{$random.uuid}}",
  "email": "c-merchant-{{$random.uuid}}@test.com",
  "password": "Admin123!",
  "fullName": "Customer Merchant"
}

> {% client.global.set("c_email", response.body.ownerEmail || response.body.email); %}

###

# @name setup_login
POST {{host}}/api/v1/auth/login
Content-Type: application/json

{
  "email": "{{c_email}}",
  "password": "Admin123!"
}

> {% client.global.set("token", response.body.token); %}

###

### 3.1 CREATE CUSTOMER
# @name createCustomer
POST {{host}}/api/v1/customers
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "firstName": "Jane",
  "lastName": "Doe-{{$random.uuid}}",
  "email": "cust-{{$random.uuid}}@test.com",
  "phone": "+1234567890"
}

> {%
    if (response.status === 201 || response.status === 200) {
        client.global.set("customerId", response.body.id);
    }
%}

###

### 3.2 LIST CUSTOMERS
GET {{host}}/api/v1/customers
Authorization: Bearer {{token}}

###

### 3.3 UPDATE CUSTOMER
PUT {{host}}/api/v1/customers/{{customerId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "firstName": "UpdatedJane",
  "lastName": "UpdatedDoe",
  "email": "updated-{{$random.uuid}}@test.com",
  "phone": "+1987654321"
}

> {%
    client.test("Update customer should succeed with 200", function() {
        client.assert(response.status === 200, "Expected 200 for PUT");
    });
%}

###

### 3.4 DELETE CUSTOMER
DELETE {{host}}/api/v1/customers/{{customerId}}
Authorization: Bearer {{token}}

> {%
    client.test("Delete customer should succeed with 204", function() {
        client.assert(response.status === 204, "Expected 204 for DELETE");
    });
%}
